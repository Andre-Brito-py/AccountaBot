{"ast":null,"code":"import axios from 'axios';\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/api';\nclass AuthService {\n  constructor() {\n    this.apiClient = axios.create({\n      baseURL: API_BASE_URL,\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    // Interceptor para adicionar token automaticamente\n    this.apiClient.interceptors.request.use(config => {\n      const token = localStorage.getItem('authToken');\n      if (token) {\n        config.headers.Authorization = `Bearer ${token}`;\n      }\n      return config;\n    }, error => {\n      return Promise.reject(error);\n    });\n\n    // Interceptor para lidar com respostas de erro\n    this.apiClient.interceptors.response.use(response => response, error => {\n      var _error$response;\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n        // Token expirado ou inválido\n        localStorage.removeItem('authToken');\n        window.location.href = '/login';\n      }\n      return Promise.reject(error);\n    });\n  }\n  async login(email, password) {\n    try {\n      const response = await this.apiClient.post('/auth/login', {\n        email,\n        password\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Erro no login:', error);\n      throw new Error('Falha na autenticação');\n    }\n  }\n  async register(userData) {\n    try {\n      const response = await this.apiClient.post('/auth/register', userData);\n      return response.data;\n    } catch (error) {\n      console.error('Erro no registro:', error);\n      throw new Error('Falha no registro');\n    }\n  }\n  async validateToken(token) {\n    try {\n      const response = await this.apiClient.get('/auth/validate', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      return response.data.user;\n    } catch (error) {\n      console.error('Erro na validação do token:', error);\n      throw new Error('Token inválido');\n    }\n  }\n  async refreshToken() {\n    try {\n      const response = await this.apiClient.post('/auth/refresh');\n      return response.data.token;\n    } catch (error) {\n      console.error('Erro ao renovar token:', error);\n      throw new Error('Falha ao renovar token');\n    }\n  }\n  async logout() {\n    try {\n      await this.apiClient.post('/auth/logout');\n    } catch (error) {\n      console.error('Erro no logout:', error);\n    } finally {\n      localStorage.removeItem('authToken');\n    }\n  }\n  async changePassword(currentPassword, newPassword) {\n    try {\n      await this.apiClient.post('/auth/change-password', {\n        currentPassword,\n        newPassword\n      });\n      return true;\n    } catch (error) {\n      console.error('Erro ao alterar senha:', error);\n      return false;\n    }\n  }\n  async resetPassword(email) {\n    try {\n      await this.apiClient.post('/auth/reset-password', {\n        email\n      });\n      return true;\n    } catch (error) {\n      console.error('Erro ao solicitar reset de senha:', error);\n      return false;\n    }\n  }\n  getToken() {\n    return localStorage.getItem('authToken');\n  }\n  isAuthenticated() {\n    const token = this.getToken();\n    return !!token;\n  }\n}\nexport const authService = new AuthService();\nexport default authService;","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","AuthService","constructor","apiClient","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","response","_error$response","status","removeItem","window","location","href","login","email","password","post","data","console","Error","register","userData","validateToken","get","user","refreshToken","logout","changePassword","currentPassword","newPassword","resetPassword","getToken","isAuthenticated","authService"],"sources":["C:/Users/Usuário/Documents/novo/IA_MARK_01/frontend/src/services/authService.ts"],"sourcesContent":["import axios from 'axios';\n\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/api';\n\ninterface LoginResponse {\n  success: boolean;\n  token: string;\n  user: {\n    id: string;\n    email: string;\n    name: string;\n    role: string;\n  };\n}\n\ninterface User {\n  id: string;\n  email: string;\n  name: string;\n  role: string;\n}\n\nclass AuthService {\n  private apiClient = axios.create({\n    baseURL: API_BASE_URL,\n    headers: {\n      'Content-Type': 'application/json',\n    },\n  });\n\n  constructor() {\n    // Interceptor para adicionar token automaticamente\n    this.apiClient.interceptors.request.use(\n      (config) => {\n        const token = localStorage.getItem('authToken');\n        if (token) {\n          config.headers.Authorization = `Bearer ${token}`;\n        }\n        return config;\n      },\n      (error) => {\n        return Promise.reject(error);\n      }\n    );\n\n    // Interceptor para lidar com respostas de erro\n    this.apiClient.interceptors.response.use(\n      (response) => response,\n      (error) => {\n        if (error.response?.status === 401) {\n          // Token expirado ou inválido\n          localStorage.removeItem('authToken');\n          window.location.href = '/login';\n        }\n        return Promise.reject(error);\n      }\n    );\n  }\n\n  async login(email: string, password: string): Promise<LoginResponse> {\n    try {\n      const response = await this.apiClient.post('/auth/login', {\n        email,\n        password,\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Erro no login:', error);\n      throw new Error('Falha na autenticação');\n    }\n  }\n\n  async register(userData: {\n    name: string;\n    email: string;\n    password: string;\n  }): Promise<LoginResponse> {\n    try {\n      const response = await this.apiClient.post('/auth/register', userData);\n      return response.data;\n    } catch (error) {\n      console.error('Erro no registro:', error);\n      throw new Error('Falha no registro');\n    }\n  }\n\n  async validateToken(token: string): Promise<User> {\n    try {\n      const response = await this.apiClient.get('/auth/validate', {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n      return response.data.user;\n    } catch (error) {\n      console.error('Erro na validação do token:', error);\n      throw new Error('Token inválido');\n    }\n  }\n\n  async refreshToken(): Promise<string> {\n    try {\n      const response = await this.apiClient.post('/auth/refresh');\n      return response.data.token;\n    } catch (error) {\n      console.error('Erro ao renovar token:', error);\n      throw new Error('Falha ao renovar token');\n    }\n  }\n\n  async logout(): Promise<void> {\n    try {\n      await this.apiClient.post('/auth/logout');\n    } catch (error) {\n      console.error('Erro no logout:', error);\n    } finally {\n      localStorage.removeItem('authToken');\n    }\n  }\n\n  async changePassword(currentPassword: string, newPassword: string): Promise<boolean> {\n    try {\n      await this.apiClient.post('/auth/change-password', {\n        currentPassword,\n        newPassword,\n      });\n      return true;\n    } catch (error) {\n      console.error('Erro ao alterar senha:', error);\n      return false;\n    }\n  }\n\n  async resetPassword(email: string): Promise<boolean> {\n    try {\n      await this.apiClient.post('/auth/reset-password', { email });\n      return true;\n    } catch (error) {\n      console.error('Erro ao solicitar reset de senha:', error);\n      return false;\n    }\n  }\n\n  getToken(): string | null {\n    return localStorage.getItem('authToken');\n  }\n\n  isAuthenticated(): boolean {\n    const token = this.getToken();\n    return !!token;\n  }\n}\n\nexport const authService = new AuthService();\nexport default authService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}